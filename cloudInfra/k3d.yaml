kind: Simple
apiVersion: k3d.io/v1alpha3
name: mydemo
servers: 1
agents: 0
volumes:
- volume: /.workrc/clusters/mydemo/data:/data
options:
 k3d:
   wait: true
   timeout: 2m0s
   disableLoadbalancer: true
   disableImageVolume: false
   disableRollback: true
 k3s:
   extraArgs:
  #  - arg: --service-cidr=10.96.0.0/12
  #    nodeFilters:
  #    - server:*
  #  - arg: --cluster-cidr=10.244.0.0/16
     nodeFilters:
     - server:*
   - arg: --disable=servicelb
     nodeFilters:
     - server:*
   - arg: --disable=traefik
     nodeFilters:
     - server:*
   - arg: --disable-network-policy
     nodeFilters:
     - server:*

  extraServerArgs:
    - --tls-san=127.0.0.1
    - --no-deploy=traefik

---
# my-cluster.yaml
apiVersion: k3d.io/v1alpha2
kind: Simple
name: my-cluster
servers: 3
agents: 3
volumes:
  - volume: /home/selcuk/k3d/calico.yaml:/var/lib/rancher/k3s/server/manifests/calico.yaml
    nodeFilters:
      - server[*]
      - agent[*]
ports:
  - port: 8080:80
    nodeFilters:
      - loadbalancer
options:
  k3s:
    extraServerArgs:
      - --flannel-backend=none
      - --no-deploy=traefik
